"          _
"  __   __(_) _ __ ___   _ __  ___
"  \ \ / /| || '_ ` _ \ | '__|/ __|
"  _\ V / | || | | | | || |  | (__
" (_)\_/  |_||_| |_| |_||_|   \___|
"

"" Table (Search for [nn])
"" settings [sx]
"" vim plug [px]
"" mappings [mx]
"" groups [gx]

"" functions (((
function SetColors()
  if &term == 'linux'
    set t_Co=16
    set background=dark
    colorscheme ron
  else
    set t_Co=256
    set background=dark
    colorscheme retrobox
  endif
endfunction

function Indent()
  :normal! mpHmogg=G'ozt`p
endfunction
"" )))

"" settings sx (((
filetype plugin indent on
syntax on
set guicursor=""
call SetColors()

set tabstop=4
set shiftwidth=4
set softtabstop=4
set textwidth=0
set expandtab
set nowrap

set autoindent
set copyindent
set smartindent

set autochdir
set autoread
set hidden

set cursorline
set cursorlineopt=number

set ignorecase
set smartcase
set incsearch
set nohlsearch

set number
set relativenumber

set foldmarker=(((,)))
set signcolumn=yes
set laststatus=2
set noruler
set statusline=
" set statusline=(%n)\ %F\ %h%m%r%w\ [%Y]\ %q%=%-14.(col:\ %c\ [%l:%L]%)\ (%b\ 0x%B)\ (%o\ -\ 0x%O)\ %a\ %p%%\ %P\ %t\ |
set modeline

set showmatch
set showcmd
set noshowmode
set scrolloff=5
set sidescrolloff=8
set path+=**

set updatetime=250
set completeopt=menuone,popup
set wildmode=list:longest,full

set noundofile
set noswapfile
set backupdir=~/.vim/backup
set writebackup
set backup

let mapleader=" "
let maplocalleader="\\"
" )))

" plugins px (((
let g:ale_set_signs = 1
let g:ale_max_signs = -1
" let g:ale_close_preview_on_insert = 1
let g:ale_completion_enabled = 1
let g:ale_lsp_suggestions = 1
let g:ale_linters_explicit = 1
let g:ale_warn_about_trailing_blank_lines = 1
let g:ale_warn_about_trailing_whitespace = 1

" 2=all, 1=current, 0=disabled
" let g:ale_virtualtext_cursor = 'all'
let g:ale_virtualtext_cursor = 1
let g:ale_sign_error = '>>'
let g:ale_sign_warning = '--'
let g:ale_echo_msg_error_str = 'E'
let g:ale_echo_msg_warning_str = 'W'
let g:ale_echo_msg_info_str = 'I'
let g:ale_echo_msg_format = '%code: %%s [%type%] [%linter%]'
let g:ale_loclist_msg_format = '%code: %%s [%severity%] [%linter%]'
let g:ale_sign_column_always = 1
let g:ale_set_highlights = 1
let g:ale_popup_menu_enabled = 0

"" Set preview 1, detail 0. With bot at 1 a popup
"" bubble will show with err/warn info
let g:ale_detail_to_floating_preview = 1
let g:ale_cursor_detail = 0

let g:ale_floating_window_border = ['│', '─', '╭', '╮', '╯', '╰', '│', '─']
let g:ale_disable_lsp = 0
let g:ale_lint_on_text_changed = 'normal'
let g:ale_lint_on_insert_leave = 1
let g:ale_lint_on_enter = 1
let g:ale_set_loclist = 0
let g:ale_set_quickfix = 1
let g:ale_open_list = 0
let g:ale_lint_on_save = 1
let g:ale_fix_on_save = 1
let g:ale_enabled = 1

"" vim plug
call plug#begin()
Plug 'morhetz/gruvbox'
Plug 'mattn/emmet-vim'
Plug 'easymotion/vim-easymotion'
Plug 'christoomey/vim-tmux-navigator'
Plug 'dense-analysis/ale'
Plug 'mbbill/undotree'
Plug 'nvie/vim-flake8'
Plug 'tpope/vim-fugitive'
" Plug 'scrooloose/nerdtree'
Plug 'airblade/vim-gitgutter'
Plug 'itchyny/lightline.vim'
Plug 'msanders/snipmate.vim'
Plug 'honza/vim-snippets'
Plug 'liuchengxu/vim-which-key'
call plug#end()

let g:ale_linters = {
      \ 'python': ['flake8'],
      \ 'rust': ['analyzer'],
      \ 'vim': [''],
      \ 'cpp': ['clangd', 'cpplint'],
      \ 'c': ['cppcheck', 'cpplint'],
      \ 'json': ['eslint'],
      \ }
let g:ale_fixers = {
      \ '*': ['remove_trailing_lines', 'trim_whitespace'],
      \ 'python': ['black', 'isort'],
      \ 'rust': ['rustfmt'],
      \ 'cpp': ['clang-format'],
      \ 'c': ['clang-format'],
      \ 'json': ['prettier'],
      \ }

nnoremap <leader>alf :ALEFix<CR>
nnoremap <leader>alo :lopen<CR>
nnoremap <leader>alc :copen<CR>
nnoremap <leader>all :ALELint<CR>
nnoremap <leader>alt :ALEToggle<CR>
nnoremap <leader>ali :ALEInfo<CR>
nmap <silent> <C-p> <Plug>(ale_previous_wrap)
nmap <silent> <C-n> <Plug>(ale_next_wrap)

let g:user_emmet_mode='inv'
let g:user_emmet_leader_key=','

map ,f <Plug>(easymotion-bd-f)
nmap ,f <Plug>(easymotion-overwin-f)
nmap ,s <Plug>(easymotion-overwin-f2)
map ,L <Plug>(easymotion-bd-jk)
nmap ,L <Plug>(easymotion-overwin-line)
map ,w <Plug>(easymotion-bd-w)
nmap ,w <Plug>(easymotion-overwin-w)

nnoremap <leader>ut :UndotreeToggle<cr><C-w>h<C-w>l
nnoremap <leader>ga :Git add .<CR>
nnoremap <leader>gc :Git commit<CR> "

nnoremap <silent> <leader> :WhichKey '<Space>'<CR>
nnoremap <silent> <localleader> :WhichKey '\'<CR>

" The colorscheme for lightline.vim.
" Currently, wombat, solarized, powerline, powerlineish,
" jellybeans, molokai, seoul256, darcula,
" selenized_dark, selenized_black, selenized_light, selenized_white,
" Tomorrow, Tomorrow_Night, Tomorrow_Night_Blue,
" Tomorrow_Night_Bright, Tomorrow_Night_Eighties, PaperColor,
" landscape, one, materia, material, OldHope, nord, deus,
" simpleblack, srcery_drk, ayu_mirage, ayu_light, ayu_dark,
" apprentice, rosepine, and 16color are available.
let g:lightline = {
      \ 'colorscheme': 'seoul256',
      \ }
" )))

" macros (((
" )))

"" mappings mx (((
inoremap kj <ESC>
vnoremap kj <ESC>

nnoremap <silent> <leader>w :write<cr>
nnoremap <silent> <leader>q ZQ
nnoremap <silent> <leader>z ZZ
nnoremap <silent> <leader>o :edit .<CR>
nnoremap <silent> <localleader>e :edit $MYVIMRC<cr>
nnoremap <silent> <localleader>ve :vsplit<cr><C-w>l:edit $MYVIMRC<cr>
nnoremap <localleader>s :write<cr>:source $MYVIMRC<cr>
" nnoremap <leader>t :write<CR>:shell<CR>
nnoremap <localleader>t :write<CR>:terminal<CR>

nnoremap <C-f> <C-d>
nnoremap <silent> <leader>bn :bnext<cr>
nnoremap <silent> <leader>bp :bprevious<cr>
nnoremap w W
nnoremap ,a zt
nnoremap ,b zb
nnoremap ,z zz
nnoremap <S-b> _
nnoremap <S-e> $
nnoremap <S-y> y$
nnoremap n nzz
nnoremap N Nzz
nnoremap ' `
nnoremap '' ``
nnoremap <F8> @
nnoremap <F9> @@
vnoremap J :m '>+1<CR>gv=gv
vnoremap K :m '<-2<CR>gv=gv
vnoremap < <gv
vnoremap > >gv
nnoremap <leader>* :%s/\<<C-r><C-w>\>//gI<left><left><left>
nnoremap <leader>& :%s/\<<C-r><C-w>\>//gIc<left><left><left><left>
nnoremap <leader>L :s/\<<C-r><C-w>\>//gI<left><left><left>
nnoremap <localleader>sh gg/<<<<<<<<CR>dd/=======<CR>V/>>>>>>><CR>d<ESC>
nnoremap <localleader>sr gg/<<<<<<<<CR>V/=======<CR>d/>>>>>>><CR>dd<ESC>
nnoremap <localleader>sb gg/<<<<<<<<CR>dd/=======<CR>dd/>>>>>>><CR>dd<ESC>
nnoremap <localleader>fc /<<<<<<<<CR>

nnoremap <leader>tn :tabnew<CR>
nnoremap <leader>nt :tabnext<CR>
nnoremap <leader>pt :tabprevious<CR>

nnoremap <silent> <leader>v :vsplit<cr><C-w>l
nnoremap <silent> <leader>s :split<cr><C-w>j
nnoremap <silent> <C-h> <C-w>h
nnoremap <silent> <C-j> <C-w>j
nnoremap <silent> <C-k> <C-w>k
nnoremap <silent> <C-l> <C-w>l
nnoremap <leader>hh :vertical resize+1<CR>
nnoremap <leader>ll :vertical resize-1<CR>
nnoremap <leader>jj :resize+1<CR>
nnoremap <leader>kk :resize-1<CR>
nnoremap <leader>rs <C-w>= " )))

"" groups gx (((
augroup ALL " (((
  au!
  " au BufReadPost,BufWritepre $MYVIMRC,*.vim,*.c,*.h,*.html,*.css,*.cpp :normal! mpHmogg=G'ozt`p
  au BufReadPost,BufWritepre $MYVIMRC,*.vim,*.c,*.h,*.html,*.css,*.cpp :call Indent()
  au BufWritePre,VimLeave * :normal! mp
  au BufWritePre * %s/\s\+$//e
  au BufWritePost,VimEnter * :normal! `p
  au BufEnter * iabbrev teh the
  au InsertEnter * silent set nornu
  au InsertLeave * silent set rnu
augroup END " )))

augroup VIM " (((
  au!
  au filetype vim silent setlocal ts=2 sw=2 sts=2 fdm=marker fdc=1 fdl=2 fdls=-1
augroup END " )))

augroup PYTHON " (((
  au!
  au FileType python silent setlocal fdm=indent fdc=0 fdl=99 fdls=99 cc=80
  au BufEnter *.py nnoremap <buffer> <F7> :write<CR>:python3 %<CR>
  au BufEnter *.py nnoremap <buffer> <F5> :write<CR>:!python3 %<CR>
  au BufEnter *.py iabbrev <buffer> slef self
  au BufEnter *.py iabbrev <buffer> sefl self
  au BufEnter *.py iabbrev <buffer> pirnt print
  au BufEnter *.py iabbrev <buffer> prnit print
  au BufEnter *.py iabbrev <buffer> pritn print
  au BufEnter *.py nnoremap <buffer> <localleader>os :edit ~/.vim/plugged/snipmate.vim/snippets/python.snippets<CR>
  au BufEnter *.py let @s=":vsplitl:edit ~/notes/pysnips.snippets:vertical resize-45h"
augroup END " )))

augroup C " (((
  au FileType c,cpp silent setlocal fdm=indent fdc=4 fdl=2 fdls=1 cc=80
  au BufEnter *.c let @s=":vsplitl:edit ~/notes/c_snips.txt:vertical resize-45h"
augroup END " )))

augroup ARDUINO " (((
  au!
  au FileType arduino silent setlocal ts=2 sw=2 sts=2 tw=0 cc=80 fdm=indent
augroup END " )))

augroup RUST " (((
  au!
  au VimEnter *.rs silent loadview
  au FileType rust silent setlocal ts=4 sw=4 sts=4 tw=0 et nowrap fdm=indent
        \ fdc=4 fdl=2 fdls=1 cc=80 noai nosi noci cin cino=ln,c2
  au BufEnter *.rs nnoremap <buffer> <leader>rr :!cargo run<CR>
  au BufEnter *.rs nnoremap <buffer> <leader>rc :!cargo check<CR>
  au BufEnter *.rs nnoremap <buffer> <leader>rb :!cargo build<CR>
  au BufEnter *.rs nnoremap <buffer> <leader>b A<SPACE>{<CR>}<ESC>ko
  au VimLeave *.rs mkview
augroup END
"" )))

augroup TEXT " (((
  au FileType text silent setlocal ts=9 sw=8 sts=4 tw=78 ai si ci cc=80 noet wrap ml lbr
  au BufEnter *.txt colorscheme quiet
  au BufLeave *.txt call SetColors()
augroup END " )))

" augroup NERDTREE " (((
"   autocmd!
"   autocmd StdinReadPre * let s:std_in = 1
"   autocmd VimEnter * if argc() == 0 && !exists('s:std_in') | NERDTree | endif
"   autocmd BufEnter * if tabpagenr('$') == 1 && winnr('$') == 1 && exists('b:NERDTree') && b:NERDTree.isTabTree() | quit | endif
"   autocmd BufEnter * if winnr('$') == 1 && exists('b:NERDTree') && b:NERDTree.isTabTree() | quit | endif
"   autocmd BufEnter * if bufname('#') =~ 'NERD_tree_\d\+' && bufname('%') !~ 'NERD_tree_\d\+' && winnr('$') > 1 | let buf=bufnr() | buffer# | execute "normal! \<C-W>w" | execute 'buffer'.buf | endif
" augroup END " )))
" )))
